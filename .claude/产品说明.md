# 用户需求文档

## 项目概述

编写浏览器端库工具，封装 PeerJS 为类似 HTTP 的 API。

## API 设计

### 客户端（发送请求）

```js
import { PeerJsWrapper } from 'sx-peerjs-http-util';

const wrapper = new PeerJsWrapper();
const data = await wrapper.send(peerId, '/api/hello', { name: 'world' });
console.log(data); // 直接输出响应数据（自动拆箱）
```

### 服务端（接收请求）

```js
wrapper.registerHandler('/api/hello', (data) => {
  return { message: 'hello' }; // 直接返回数据，自动包装成 { status: 200, data }
});
wrapper.unregisterHandler('/api/hello');
```

## 核心机制

### 连接管理
- 每次请求创建新 conn

### 装箱/拆箱
- send 返回 Promise 自动拆箱，只返回 data 部分
- registerHandler 处理器直接返回数据，自动装箱

### 请求/响应简化
- Request: `{ path, data }`
- Response: `{ status, data }`
- 不需要 header

## 目标环境

浏览器端（非 Node.js 后端）

## 技术要求

使用 TypeScript。

## 测试要求

E2E 测试（仅 Chrome）。

## 自动发布

根据 `common-knowledge/github-action/GitHub Actions 自动发布到 npmjs.md` 实现，提交后自动发布到 npmjs。

npm 包名：`sx-peerjs-http-util`
